## 脅威モデリング
DevSecOps の取り組みで重要なのは、脅威モデリングとそのリスクの評価です。そこでこのパートでは、このトピックについてみていきたいと思います。

### 脅威モデリングとは何か？
これはアプリケーションを攻撃できる可能性があるすべての方法を体系的にリストしたものです。つまり脅威モデリングは攻撃を積極的に検討するプロセスです。このプロセスのアウトプットは脅威や起こりうる脅威シナリオのリストです。また、アプリケーションの特定の部分ではなくすべての脅威を考慮するために、私たちのアプローチは全体的でなければなりません。一方、脅威モデリングは **協調的** かつ **反復可能な** プロセスです。
#### プロセスアウトプット
+ ダイアグラム
+ セキュリティ要件
+ 非要件
+ 脅威や脆弱性のリスト

#### 用語
+ 弱点 (Weakness):
ソフトウェアの欠陥やバグ (例: ユーザー電子メールバリデーションの欠落)
+ 脆弱性 (Vulnerability):
悪用可能な弱点 (例: ユーザー電子メールフィールドを悪用して SQL ステートメントを挿入できる)
+ 攻撃 (Attack)
    - ターゲット (Target): 攻撃の価値
    - 攻撃ベクトル (Attack Vector): 攻撃者が脆弱性を悪用するためにたどることができる経路
    - 脅威アクター (Threat Actor): 脅威の発生源
+ 攻撃対象領域 (Attack Surface):
脅威アクターが入手、使用、または攻撃できる可能性のあるもの
+ リスク (Risk):
リスク (Risk) = 影響 (Impact) * 発生可能性 (Likelihood)

### なぜ脅威モデリングなのか？
脅威モデリングを使用する主な理由としては以下のことが挙げられます。
+ 脅威を発見するためのプロアクティブなアプローチ
+ コスト削減による効率向上
+ バグに基づくより適切な優先順位付けと緩和策の計画
+ システムの理解が深まる


### 脅威モデルは誰がすべきか？
+ アーキテクト、アプリケーションがどのように設計されているか、どのようにデータが流れているかを知っています。
+ 開発者、アプリケーションがどのように構築されたか、コンポーネント間の相互連携についての詳細を知っています。
+ テスト担当者、要件とアプリケーションが何をすべきかを知っています。
+ セキュリティ専門家、特定の攻撃要因と脆弱性について知っています。
しかしながら、この質問に対するベストアンサーは **組織による** となります。

### 脅威モデリングをいつ実施するか？
ソフトウェアの脆弱性は早期に発見するほど簡単かつ安価に修正できますので、脅威モデリングはソフトウェア設計プロセスのできるだけ早い段階で行うべきです。アジャイル環境で作業している場合、理想的には各スプリントで脅威モデリングを行うべきです。
## 適切なアプローチと方法論の選択
ここでは一つ目に脅威モデリングをどのようにプロセスを開始するかを説明する「アプローチ」、二つ目にプロセスそのものを説明する「方法論」を挙げています。それぞれの方法論は 3 つの利用可能なアプローチの一つに基づいています。
### アプローチ
+ **資産中心のアプローチ**:
その名の通り、資産を中心に回します。したがって作成手順は以下のとおりです。
    1. 資産のリストを作成する
    2. 資産、コンポーネント、データフローを描く
    3. 要素ごとに脅威をチェックする

これらの手順をすべての資産に対して繰り返すことで、脅威のリストが作成されます。

+ **攻撃者中心のアプローチ**:
攻撃者の視点から脅威モデリングを見ます。したがって作成手順は以下のとおりです。
    1. 脅威アクターのリストを作成する
        - 動機
        - 手段
        - 機会
    2. 脅威のリストを作成する

+ **アプリケーション中心のアプローチ**:
これは最初にリスクや攻撃について考えるのではなく、アプリケーションを視覚化することから始めます。したがって作成手順は以下のとおりです。
    1. アプリケーションのダイアグラムを描く
    2. 要素ごとに脅威をリストする
        - STRIDE
        - OWASP TOP 10
    
    3. 分類モデルを使用して脅威をランク付けする


### 方法論
アプローチに応じて、以下のような方法論のリストがあります。
+ PASTA
+ Microsoft Threat Modeling
+ OCTAVE
+ TRIKE
+ VAST